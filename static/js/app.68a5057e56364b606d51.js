webpackJsonp([0],[,,function(t,e,a){"use strict";var s=a(0),n=a(16),r=a(13),c=a.n(r);s.a.use(n.a),e.a=new n.a({routes:[{path:"/",name:"Hello",component:c.a}]})},function(t,e,a){function s(t){a(10)}var n=a(1)(a(5),a(14),s,null,null);t.exports=n.exports},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(0),n=a(3),r=a.n(n),c=a(2);s.a.config.productionTip=!1,new s.a({el:"#app",router:c.a,template:"<App/>",components:{App:r.a}})},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(0),n=a(7),r=a(17),c=a.n(r),i=a(9),o=(a.n(i),a(8));a.n(o);s.a.use(n.a);var l={dblClickTime:0,scaleFactor:1,canvas:null,spinner:null,scene:null,canvasScale:function(){var t=l.canvas.getWidth(),e=l.canvas.getHeight(),a=t/e,s=$("#canvasRow").width(),n=Math.min(s,t),r=Math.round(n/a);$("#canvasContainer").css({width:n+4+"px",height:r+4+"px"}),$("canvas,.canvas-container").css({width:"100%",height:"100%"}),l.scaleFactor=t/n,console.log("scale factor:",l.scaleFactor),l.canvas.renderAll()},showObjProps:function(t){var e=Math.round(t.angle);e>=360&&(e-=360),$("#objProps").show().html(Math.round(t.left)+","+Math.round(t.top)+" | "+Math.round(t.width*t.scaleX)+"x"+Math.round(t.height*t.scaleY)+" | "+e+"&deg;")}};e.default={name:"app",components:{vueSlider:c.a},data:function(){return{foo:"bar",sceneOpacity:.5,appDisplay:"block",tabIndex:null,scenes:[{imgSrc:"400216478_thumb.jpg",dataSrc:"400216478.png",dataSize:"1280x960",dataHoles:'["656,424 116x132 330"]'},{imgSrc:"989357250_thumb.jpg",dataSrc:"989357250.png",dataSize:"1280x960",dataHoles:'["842,464 146x171 0"]'},{imgSrc:"1912408125_thumb.jpg",dataSrc:"1912408125.png",dataSize:"1280x960",dataHoles:'["596,353 689x410 0"]'},{imgSrc:"1960232057_thumb.jpg",dataSrc:"1960232057.png",dataSize:"1280x960",dataHoles:'["596,353 689x410 0"]'}],mugshots:[{imgSrc:"3b2014dcefb972a6.png",dataUId:0,dataSize:"159x190"}]}},mounted:function(){var t=this;$(function(){try{fabric.Object.prototype.originX="center",fabric.Object.prototype.originY="center",fabric.Object.prototype.cornerColor="yellow",fabric.Object.prototype.borderColor="red",fabric.Object.prototype.cornerSize=16,l.canvas=new fabric.Canvas("canvas",{preserveObjectStacking:!0,enableRetinaScaling:!1,stopContextMenu:!0});var e=new fabric.Rect({left:100,top:100,fill:"red",width:20,height:20});l.canvas.add(e);var a=$("#scenes img:first");fabric.Image.fromURL("./static/scenes/"+t.scenes[0].dataSrc,function(e){if(void 0===e.getElement())return void console.log("背景图片加载失败！");l.scene={$img:a,fabricImg:e},e.set({originX:"left",originY:"top",opacity:t.sceneOpacity}),l.canvas.setWidth(e.width).setHeight(e.height),l.canvas.setOverlayImage(e,l.canvasScale)});fabric.Image.fromURL("./static/mugshots/"+t.mugshots.find(function(t){return 0===t.dataUId}).imgSrc,function(e){if(void 0===e.getElement())return void console.log("脸图片加载失败！");e.scale(1).setCoords(),e.set({uid:0,left:t.parseHoles(a.data("holes"))[0].left,top:t.parseHoles(a.data("holes"))[0].top}),l.canvas.add(e),l.canvas.setActiveObject(e),l.showObjProps(e)}),l.canvasScale(),l.canvas.on({"selection:cleared":function(){},"selection:created":function(){},"object:moving":function(t){l.showObjProps(t.target)},"object:scaling":function(t){l.showObjProps(t.target)},"object:selected":function(t){var e=t.target;l.showObjProps(e)},"object:rotating":function(t){l.showObjProps(t.target)},"object:removed":function(){$("#objProps").hide()}})}catch(t){console.log("something is wrong with fabric init:",t)}})},methods:{parseHoles:function(t){return t.map(function(t){var e=t.split(" "),a=e[0].split(","),s=e[1].split("x");return{left:parseInt(a[0],10),top:parseInt(a[1],10),width:parseInt(s[0],10),height:parseInt(s[1],10),angle:parseInt(e[2],10)}})},handleChangeScene:function(t){function e(t,a,s){var n=t[s].split(" "),r=n[0].split(","),c=+r[0],i=+r[1],o=n[1].split("x"),u=+o[0],d=+o[1],v=+n[2],p=a[s],g=$('#mugshots img[data-uid="'+p+'"]'),h=g.attr("src"),f=g.data("size").split("x"),m=+f[0],b=+f[1];fabric.Image.fromURL(h,function(n){n.set({url:h,uid:p,left:c,top:i,angle:v,originX:"center",originY:"center",scaleX:u/m,scaleY:d/b}).setCoords(),l.canvas.add(n),0===s&&(l.showObjProps(n),l.canvas.setActiveObject(n)),$('#mugshots img[data-uid="'+p+'"]').addClass("oncanvas"),s<a.length-1&&s<t.length-1?e(t,a,s+1):l.canvas.renderAll()})}var a=this,s=$(t.target),n=s.data("size").split("x"),r=s.data("holes"),c=n[0],i=n[1],o=[];l.canvas.forEachObject(function(t){"image"===t.type&&(o.push(t.uid),$('#mugshots img[data-uid="'+t.uid+'"]').removeClass("oncanvas"),t.remove())}),l.canvas.setWidth(c).setHeight(i),l.canvasScale(),fabric.Image.fromURL(s.data("src"),function(t){l.scene={$img:s,fabricImg:t},t.set({originX:"left",originY:"top",opacity:a.sceneOpacity}),l.canvas.setOverlayImage(t,function(){o.length>0?e(r,o,0):l.canvas.renderAll()})})},handleChangeMugshot:function(){}},watch:{sceneOpacity:function(t){l.scene.fabricImg.set("opacity",t),l.canvas.renderAll()}}}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"hello",data:function(){return{msg:"Welcome to Your Vue.js App"}}}},,function(t,e){},function(t,e){},function(t,e){},function(t,e){},,function(t,e,a){function s(t){a(11)}var n=a(1)(a(6),a(15),s,"data-v-3d41279c",null);t.exports=n.exports},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container-fluid",style:{display:t.appDisplay},attrs:{id:"app"}},[a("b-card",{staticClass:"cf-tabs-card",staticStyle:{"margin-bottom":"20px"},attrs:{"no-block":""}},[a("b-tabs",{ref:"tabs",attrs:{small:"",card:""},model:{value:t.tabIndex,callback:function(e){t.tabIndex=e},expression:"tabIndex"}},[a("b-tab",{staticClass:"scroller",attrs:{title:"更换背景",id:"scenes"}},t._l(t.scenes,function(e){return a("div",{staticClass:"scene"},[a("img",{attrs:{src:"./static/scenes/"+e.imgSrc,"data-src":"./static/scenes/"+e.dataSrc,"data-size":e.dataSize,"data-holes":e.dataHoles},on:{click:t.handleChangeScene}})])})),t._v(" "),a("b-tab",{staticClass:"scroller",attrs:{title:"更换头像",id:"mugshots"}},t._l(t.mugshots,function(e){return a("div",{staticClass:"mugshot"},[a("img",{attrs:{src:"./static/mugshots/"+e.imgSrc,"data-uid":e.dataUId,"data-size":e.dataSize},on:{click:t.handleChangeMugshot}})])}))],1)],1),t._v(" "),a("b-card",{staticClass:"mb-2",staticStyle:{width:"100%"},attrs:{tag:"article"}},[a("vue-slider",{attrs:{min:0,max:1,interval:.01},model:{value:t.sceneOpacity,callback:function(e){t.sceneOpacity=e},expression:"sceneOpacity"}})],1),t._v(" "),t._m(0)],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"canvasRow"}},[a("div",{attrs:{id:"canvasContainer"}},[a("div",{staticStyle:{display:"block"},attrs:{id:"objProps"}}),t._v(" "),a("canvas",{attrs:{id:"canvas"}})])])}]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hello"},[a("h1",[t._v(t._s(t.msg))]),t._v(" "),a("h2",[t._v("Essential Links")]),t._v(" "),t._m(0),t._v(" "),a("h2",[t._v("Ecosystem")]),t._v(" "),t._m(1)])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[a("a",{attrs:{href:"https://vuejs.org",target:"_blank"}},[t._v("Core Docs")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank"}},[t._v("Forum")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://gitter.im/vuejs/vue",target:"_blank"}},[t._v("Gitter Chat")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank"}},[t._v("Twitter")])]),t._v(" "),a("br"),t._v(" "),a("li",[a("a",{attrs:{href:"http://vuejs-templates.github.io/webpack/",target:"_blank"}},[t._v("Docs for This Template")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[a("a",{attrs:{href:"http://router.vuejs.org/",target:"_blank"}},[t._v("vue-router")])]),t._v(" "),a("li",[a("a",{attrs:{href:"http://vuex.vuejs.org/",target:"_blank"}},[t._v("vuex")])]),t._v(" "),a("li",[a("a",{attrs:{href:"http://vue-loader.vuejs.org/",target:"_blank"}},[t._v("vue-loader")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank"}},[t._v("awesome-vue")])])])}]}}],[4]);
//# sourceMappingURL=app.68a5057e56364b606d51.js.map